<% layout("/layouts/boilerplate") %>

<div class="container mt-5">
  <div class="row mb-4">
    <div class="col-md-8">
      <h1>Admin Dashboard</h1>
    </div>
  </div>

  <!-- Statistics Cards -->
  <div class="row mb-4">
    <div class="col-md-3">
      <div class="card text-center text-white bg-primary">
        <div class="card-body">
          <i class="fas fa-users fa-3x mb-3"></i>
          <h5 class="card-title">Total Requests</h5>
          <h2><%= stats.total %></h2>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card text-center text-white bg-info">
        <div class="card-body">
          <i class="fas fa-file-alt fa-3x mb-3"></i>
          <h5 class="card-title">Submitted</h5>
          <h2><%= stats.submitted %></h2>
        </div>
      </div>
    </div>
    <div class="col-md-2">
      <div class="card text-center text-white bg-warning">
        <div class="card-body">
          <i class="fas fa-clock fa-3x mb-3"></i>
          <h5 class="card-title">Under Review</h5>
          <h2><%= stats.underReview %></h2>
        </div>
      </div>
    </div>
    <div class="col-md-2">
      <div class="card text-center text-white bg-success">
        <div class="card-body">
          <i class="fas fa-check-circle fa-3x mb-3"></i>
          <h5 class="card-title">Approved</h5>
          <h2><%= stats.approved %></h2>
        </div>
      </div>
    </div>
    <div class="col-md-2">
      <div class="card text-center text-white bg-danger">
        <div class="card-body">
          <i class="fas fa-times-circle fa-3x mb-3"></i>
          <h5 class="card-title">Rejected</h5>
          <h2><%= stats.rejected %></h2>
        </div>
      </div>
    </div>
  </div>

  <!-- Quick Actions -->
  <div class="row mb-4">
    <div class="col-md-12">
      <div class="card">
        <div class="card-body text-center">
          <h5 class="card-title mb-3">Quick Actions</h5>
          <a
            href="/admin/host-requests?status=submitted"
            class="btn btn-primary me-2"
            >Review New Requests</a
          >
          <a
            href="/admin/host-requests?status=under_review"
            class="btn btn-warning me-2"
            >Continue Review</a
          >
          <a href="/admin/host-requests" class="btn btn-outline-primary"
            >View All Requests</a
          >
        </div>
      </div>
    </div>
  </div>

  <!-- Recent Requests -->
  <div class="row">
    <div class="col-md-12">
      <div class="card">
        <div class="card-header bg-light">
          <h5 class="mb-0">Recent Host Requests</h5>
        </div>
        <div class="list-group list-group-flush">
          <% recentRequests.forEach(req => { %>
          <a
            href="/admin/host-requests/<%= req._id %>"
            class="list-group-item list-group-item-action"
          >
            <div class="d-flex w-100 justify-content-between">
              <h5 class="mb-1">
                <%= req.personalInfo.firstName %> <%= req.personalInfo.lastName
                %>
              </h5>
              <small
                ><%= req.submittedAt ? req.submittedAt.toLocaleDateString() :
                'N/A' %></small
              >
            </div>
            <p class="mb-1"><%= req.personalInfo.email %></p>
            <small>
              <% if (req.applicationStatus === 'submitted') { %>
              <span class="badge bg-info">Submitted</span>
              <% } else if (req.applicationStatus === 'under_review') { %>
              <span class="badge bg-warning">Under Review</span>
              <% } else if (req.applicationStatus === 'approved') { %>
              <span class="badge bg-success">Approved</span>
              <% } else if (req.applicationStatus === 'rejected') { %>
              <span class="badge bg-danger">Rejected</span>
              <% } else { %>
              <span class="badge bg-secondary"
                ><%= req.applicationStatus %></span
              >
              <% } %>
            </small>
          </a>
          <% }); %>
        </div>
        <% if (recentRequests.length === 0) { %>
        <div class="card-body text-center text-muted">
          <p>No recent requests</p>
        </div>
        <% } %>
      </div>
    </div>
  </div>
</div>

<style>
  .card {
    box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
    border: none;
  }
  .card-body h2 {
    margin-bottom: 0;
  }
</style>
